<h2 mat-dialog-title>Crear Factura</h2>

<div *ngIf="createdBillId == 0">
    <mat-dialog-content>
        <p>
            Seleccione el medio de pago por el cual se realizará el pago de esta factura.
        </p>
        <form class="example-form" [formGroup]="billForm" (ngSubmit)="submitBill()">
            <div class="row">
                <div class="col-12 m-b-12">
                    <mat-form-field appearance="outline" class="w-100" color="primary">
                        <mat-label>Selecciona un medio de pago</mat-label>
                        <mat-select formControlName="methodId">
                            <mat-option *ngFor="let payment of paymentMethodList" [value]="payment.method_id">
                                {{ payment.method_name }}
                            </mat-option>
                        </mat-select>
                        @if (billForm.get('methodId')?.hasError('required')) {
                        <mat-error>El medio de pago es <strong>obligatorio.</strong></mat-error>
                        }
                    </mat-form-field>
                </div>
            </div>
        </form>
    </mat-dialog-content>
    <mat-dialog-actions align="end">
        <button mat-stroked-button color="warn" mat-dialog-close>Cancelar</button>
        <button mat-flat-button type=" submit" color="primary" class="m-r-8 " [disabled]="billForm.invalid" (click)="submitBill()">Crear
            Factura</button>
    </mat-dialog-actions>
</div>

<div *ngIf="createdBillId != 0">
    <mat-dialog-content>
        <p>
            Para completar la creación de la factura ingrese los detalles a continuación.
        </p>
        <form class="example-form" [formGroup]="billDetailsForm" (ngSubmit)="submitBillsDetails()">
            <div class="row">
                <div class="col-12 m-b-12">
                    <mat-form-field appearance="outline" class="w-100" color="primary">
                        <mat-label>Selecciona un producto para añadir a la factura</mat-label>
                        <mat-select formControlName="product">
                            <mat-option *ngFor="let product of productsList" [value]="product.product_id">
                                {{ product.product_name }}
                            </mat-option>
                        </mat-select>
                        @if (billDetailsForm.get('product')?.hasError('required')) {
                        <mat-error>El producto es <strong>obligatorio.</strong></mat-error>
                        }
                    </mat-form-field>
                </div>
            </div>
        </form>
    </mat-dialog-content>
    <mat-dialog-actions align="end">
        <button mat-stroked-button color="warn " mat-dialog-close>Cancelar</button>
        <button mat-flat-button type=" submit " color="primary " class="m-r-8 " (click)="submitBillsDetails()" [disabled]="billDetailsForm.invalid">Añadir Detalles de Factura</button>
    </mat-dialog-actions>
</div>